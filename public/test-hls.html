<!DOCTYPE html>
<html>
<head>
    <title>Test HLS</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</head>
<body>
    <h1>Test HLS Direct</h1>
    <video id="video" controls width="800" height="600"></video>
    
    <script>
        const video = document.getElementById('video');
        const playlistUrl = '/api/playlist?from=2025-07-21&to=2025-07-21';
        
        console.log('Loading playlist:', playlistUrl);
        
        if (Hls.isSupported()) {
            const hls = new Hls({
                debug: true,
                enableWorker: false,
                lowLatencyMode: false,
                maxBufferLength: 30,
                maxMaxBufferLength: 60,
                maxBufferSize: 30 * 1000 * 1000,
                maxBufferHole: 0.1,
            });
            
            hls.loadSource(playlistUrl);
            hls.attachMedia(video);
            
            hls.on(Hls.Events.MANIFEST_PARSED, function() {
                console.log('✅ Playlist parsed successfully!');
            });
            
            hls.on(Hls.Events.FRAG_LOADED, function(event, data) {
                console.log('✅ Fragment loaded:', data.frag.url);
            });
            
            hls.on(Hls.Events.ERROR, function(event, data) {
                console.error('❌ HLS Error:', data);
            });
            
        } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
            video.src = playlistUrl;
        }
    </script>
</body>
</html>
